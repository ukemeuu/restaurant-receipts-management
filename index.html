<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Receipt Management System for Pot of Jollof - Track receipts, manage suppliers, and analyze spending">
  <meta name="keywords" content="receipt management, restaurant, supplier tracking, expense management">
  <title>Receipt Manager - Pot of Jollof</title>
  <link rel="stylesheet" href="styles.css">

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>

<body>
  <!-- Login View -->
  <div id="login-view" class="login-container">
    <div class="login-card">
      <div class="login-header">
        <div class="logo-icon" style="width: 80px; height: 80px; font-size: 3rem; margin: 0 auto var(--space-md);">ğŸ§¾
        </div>
        <h1 style="font-size: var(--font-size-3xl); margin-bottom: var(--space-xs);">Receipt Manager</h1>
        <p style="color: var(--text-secondary); font-size: var(--font-size-lg);">Pot of Jollof</p>
      </div>

      <div class="login-body">
        <p style="text-align: center; color: var(--text-secondary); margin-bottom: var(--space-lg);">
          Sign in with your Google account to continue
        </p>

        <div id="google-signin-button" style="display: flex; justify-content: center;"></div>

        <div id="login-error" class="login-error hidden"></div>
      </div>

      <div class="login-footer">
        <p style="font-size: var(--font-size-sm); color: var(--text-muted); text-align: center;">
          Secure authentication powered by Google
        </p>
      </div>
    </div>
  </div>

  <!-- Main App View (Hidden until logged in) -->
  <div id="app-view" class="hidden">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <div class="logo-icon">ğŸ§¾</div>
          <div class="logo-text">
            <h1>Receipt Manager</h1>
            <p>Pot of Jollof</p>
          </div>
        </div>
        <div class="user-info">
          <span id="user-name" class="user-name"></span>
          <button class="btn btn-secondary btn-icon" onclick="auth.logout()" title="Logout">
            ğŸšª
          </button>
        </div>
      </div>
      <nav class="nav">
        <button class="nav-btn active" data-view="dashboard">ğŸ“Š Dashboard</button>
        <button class="nav-btn" data-view="receipts">ğŸ§¾ Receipts</button>
        <button class="nav-btn" data-view="suppliers">ğŸ‘¥ Suppliers</button>
        <button class="nav-btn hidden" data-view="users" id="user-management-btn">ğŸ‘¤ Users</button>
      </nav>
    </header>

    <main class="container">
      <!-- Dashboard View -->
      <div id="dashboard-view" class="view">
        <!-- Stats Cards -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">ğŸ§¾</div>
            <div class="stat-label">Total Receipts</div>
            <div class="stat-value" id="total-receipts">0</div>
          </div>
          <div class="stat-card secondary">
            <div class="stat-icon">ğŸ’°</div>
            <div class="stat-label">Total Spending</div>
            <div class="stat-value" id="total-spending">$0</div>
          </div>
          <div class="stat-card accent">
            <div class="stat-icon">ğŸ‘¥</div>
            <div class="stat-label">Active Suppliers</div>
            <div class="stat-value" id="total-suppliers">0</div>
          </div>
        </div>

        <!-- Top Suppliers -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">ğŸ† Top Suppliers</h2>
          </div>
          <div class="supplier-list" id="top-suppliers-list">
            <p class="text-center" style="color: var(--text-muted);">No suppliers yet. Add your first receipt to get
              started!</p>
          </div>
        </div>

        <!-- Recent Receipts -->
        <div class="card mt-3">
          <div class="card-header">
            <h2 class="card-title">ğŸ“‹ Recent Receipts</h2>
            <button class="btn btn-primary" id="add-receipt-btn">
              â• Add Receipt
            </button>
          </div>
          <div class="receipt-grid" id="recent-receipts">
            <p class="text-center" style="color: var(--text-muted);">No receipts yet. Click "Add Receipt" to get
              started!</p>
          </div>
        </div>
      </div>

      <!-- Receipts View -->
      <div id="receipts-view" class="view hidden">
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">ğŸ§¾ All Receipts</h2>
            <button class="btn btn-primary" id="add-receipt-btn-2">
              â• Add Receipt
            </button>
          </div>

          <!-- Search and Filters -->
          <div class="search-bar">
            <span class="search-icon">ğŸ”</span>
            <input type="text" class="search-input" id="receipt-search"
              placeholder="Search by supplier, receipt number, or date...">
          </div>

          <div class="receipt-grid" id="all-receipts">
            <p class="text-center" style="color: var(--text-muted);">No receipts found.</p>
          </div>
        </div>
      </div>

      <!-- Suppliers View -->
      <div id="suppliers-view" class="view hidden">
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">ğŸ‘¥ Manage Suppliers</h2>
            <button class="btn btn-primary" id="add-supplier-btn">
              â• Add Supplier
            </button>
          </div>

          <div class="search-bar">
            <span class="search-icon">ğŸ”</span>
            <input type="text" class="search-input" id="supplier-search" placeholder="Search suppliers...">
          </div>

          <div class="supplier-list" id="suppliers-list">
            <p class="text-center" style="color: var(--text-muted);">No suppliers yet. Add your first supplier!</p>
          </div>
        </div>
      </div>

      <!-- Users View (Management only) -->
      <div id="users-view" class="view hidden">
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">ğŸ‘¤ User Management</h2>
            <button class="btn btn-primary" id="add-user-btn">
              â• Add User
            </button>
          </div>

          <div class="users-list" id="users-list">
            <p class="text-center" style="color: var(--text-muted);">Loading users...</p>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Add Receipt Modal -->
  <div id="receipt-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">â• Add Receipt</h3>
        <button class="modal-close" id="close-receipt-modal">âœ•</button>
      </div>
      <div class="modal-body">
        <form id="receipt-form">
          <!-- Image Upload -->
          <div class="form-group">
            <label class="form-label">Receipt Image</label>
            <div class="image-upload" id="image-upload-area">
              <input type="file" id="receipt-image" accept="image/*" capture="environment" style="display: none;">
              <div id="upload-placeholder">
                <div class="upload-icon">ğŸ“·</div>
                <p class="upload-text">Click to upload or take a photo</p>
              </div>
              <img id="image-preview" class="image-preview hidden" alt="Receipt preview">
            </div>
          </div>

          <!-- Supplier -->
          <div class="form-group">
            <label class="form-label" for="receipt-supplier">Supplier</label>
            <div class="autocomplete-container">
              <input type="text" class="form-input" id="receipt-supplier" placeholder="Start typing supplier name..."
                autocomplete="off" required>
              <div class="autocomplete-dropdown hidden" id="supplier-dropdown"></div>
            </div>
          </div>

          <!-- Receipt Number -->
          <div class="form-group">
            <label class="form-label" for="receipt-number">Receipt Number</label>
            <input type="text" class="form-input" id="receipt-number" placeholder="e.g., RCP-001234" required>
          </div>

          <!-- Amount -->
          <div class="form-group">
            <label class="form-label" for="receipt-amount">Amount ($)</label>
            <input type="number" class="form-input" id="receipt-amount" placeholder="0.00" step="0.01" min="0" required>
          </div>

          <!-- Date -->
          <div class="form-group">
            <label class="form-label" for="receipt-date">Date</label>
            <input type="date" class="form-input" id="receipt-date" required>
          </div>

          <!-- Notes -->
          <div class="form-group">
            <label class="form-label" for="receipt-notes">Notes (Optional)</label>
            <textarea class="form-textarea" id="receipt-notes" placeholder="Add any additional notes..."></textarea>
          </div>

          <div class="flex gap-2">
            <button type="submit" class="btn btn-primary" style="flex: 1;">
              ğŸ’¾ Save Receipt
            </button>
            <button type="button" class="btn btn-secondary" id="cancel-receipt">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add Supplier Modal -->
  <div id="supplier-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">â• Add Supplier</h3>
        <button class="modal-close" id="close-supplier-modal">âœ•</button>
      </div>
      <div class="modal-body">
        <form id="supplier-form">
          <div class="form-group">
            <label class="form-label" for="supplier-name">Supplier Name</label>
            <input type="text" class="form-input" id="supplier-name" placeholder="e.g., Fresh Farms Market" required>
          </div>

          <div class="form-group">
            <label class="form-label" for="supplier-category">Category</label>
            <select class="form-select" id="supplier-category" required>
              <option value="">Select category...</option>
              <option value="Produce">ğŸ¥¬ Produce</option>
              <option value="Meat & Seafood">ğŸ¥© Meat & Seafood</option>
              <option value="Dairy">ğŸ¥› Dairy</option>
              <option value="Dry Goods">ğŸŒ¾ Dry Goods</option>
              <option value="Beverages">ğŸ¥¤ Beverages</option>
              <option value="Spices & Seasonings">ğŸŒ¶ï¸ Spices & Seasonings</option>
              <option value="Packaging">ğŸ“¦ Packaging</option>
              <option value="Equipment">ğŸ”§ Equipment</option>
              <option value="Other">ğŸ“‹ Other</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label" for="supplier-contact">Contact (Optional)</label>
            <input type="text" class="form-input" id="supplier-contact" placeholder="Phone or email">
          </div>

          <div class="flex gap-2">
            <button type="submit" class="btn btn-primary" style="flex: 1;">
              ğŸ’¾ Save Supplier
            </button>
            <button type="button" class="btn btn-secondary" id="cancel-supplier">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add User Modal (Management only) -->
  <div id="user-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">â• Add User</h3>
        <button class="modal-close" id="close-user-modal">âœ•</button>
      </div>
      <div class="modal-body">
        <form id="user-form">
          <div class="form-group">
            <label class="form-label" for="user-email">Email (Google Account)</label>
            <input type="email" class="form-input" id="user-email" placeholder="user@example.com" required>
          </div>

          <div class="form-group">
            <label class="form-label" for="user-name">Full Name</label>
            <input type="text" class="form-input" id="user-name-input" placeholder="John Doe" required>
          </div>

          <div class="form-group">
            <label class="form-label" for="user-role">Role</label>
            <select class="form-select" id="user-role" required>
              <option value="">Select role...</option>
              <option value="Management">ğŸ‘‘ Management (Admin)</option>
              <option value="Operations Lead">ğŸ“Š Operations Lead</option>
              <option value="Store Manager">ğŸª Store Manager</option>
            </select>
          </div>

          <div class="flex gap-2">
            <button type="submit" class="btn btn-primary" style="flex: 1;">
              ğŸ’¾ Create User
            </button>
            <button type="button" class="btn btn-secondary" id="cancel-user">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- View Receipt Modal -->
  <div id="view-receipt-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">ğŸ§¾ Receipt Details</h3>
        <button class="modal-close" id="close-view-receipt-modal">âœ•</button>
      </div>
      <div class="modal-body" id="receipt-detail-content">
        <!-- Content will be populated dynamically -->
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="config.js"></script>
  <script src="api.js"></script>
  <script src="auth.js"></script>
  <script src="app.js"></script>

  <script>
    // Initialize API
    const api = new API(CONFIG.SCRIPT_URL);

    // Check authentication on page load
    document.addEventListener('DOMContentLoaded', () => {
      auth.checkAuth();

      // Initialize Google Sign-In if on login page
      if (!auth.isAuthenticated) {
        auth.initGoogleAuth();
      }
    });
  </script>
</body>

</html>